<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de livros</title>
</head>
<body>
    <label for="ipt_nome">Nome do livro:</label>
    <input type="text" id="ipt_nome">
    <label for="ipt_autor">Autor do livro:</label>
    <input type="text" id="ipt_nome">
    <label for="ipt_ano">Ano:</label>
    <input type="text" id="ipt_ano">
    <label for="ipt_estoque">Estoque:</label>
    <input type="text" id="ipt_estoque">
    <label for="ipt_genero">Gênero:</label>
    <select name="" id="">
        <option value="#">Escolha um gênero</option>
        <option value="">Horror</option>
        <option value="">Romance</option>
        <option value="">Poesia</option>
        <option value="">Fantasia</option>
    </select>
    <label for="ipt_preco_compra">Preço compra:</label>
    <input type="text" id="ipt_preco_compra">
    <label for="ipt_preco_venda">Preço venda:</label>
    <input type="text" id="ipt_preco_venda">
    <button onclick="cadastrar()">Cadastrar</button>
    <div id="most"></div>
</body>
<script>
    function cadastrar() {
        let nome = document.getElementById('ipt_nome').value;
        let autor = Number(document.getElementById('ipt_autor').value);
        let ano = Number(document.getElementById('ipt_ano').value);
        let estoque = Number(document.getElementById('ipt_estoque').value);
        let genero = document.getElementById('ipt_genero').value;
        let preco_compra = Number(document.getElementById('ipt_preco_compra').value);
        let preco_venda = Number(document.getElementById('ipt_preco_venda').value);

        var corpo = {
            nome: nome.value,
            autor: autor.value,
            ano: nome.value,
            estoque: autor.value,
            genero: nome.value,
            preco_compra: autor.value,
            preco_venda: nome.value,
        }

        if (!nome || !ano || !estoque || !genero || !preco_compra || !preco_venda) {
            most.innerHTML = `Preencha todos os campos` ;
            return;  
        }

        fetch(`/cadastro_livro/cadastrar/`, {
            method: "post",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(corpo)
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                limparFormulario();
                finalizarAguardar();
            } else if (resposta.status == 404) {
                window.alert("Deu 404!");
            } else {
                throw ("Houve um erro ao tentar realizar a postagem! Código da resposta: " + resposta.status);
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
            finalizarAguardar();
        });

        return false;
    }
</script>
</html>